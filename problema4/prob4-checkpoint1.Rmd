---
title: "Problema 4 - checkpoint 1"
output: html_document
---

```{r global_options, include=TRUE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE, fig.width=12, fig.height=6)
```

 

```{r echo=FALSE}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
theme_set(theme_bw())

filmes = read.csv("dados/movies.csv",  encoding="UTF-8")
ratings = read.csv("dados/ratings.csv",  encoding="UTF-8")

```

1 - Escolha uma trilogia (ou uma n-logia com n > 3) e avalie para qual dos episódios da trilogia há melhor avaliação e para qual há mais variação nas notas atribuídas ao filme.

Para a primeira parte, iremos escolher a trilogia Senhor dos Anéis.

```{r}

filmes.senhor.dos.aneis = filmes %>%
  filter(grepl('Lord of the Rings', title))

senhor.dos.aneis.ratings = ratings %>%
   filter(movieId %in% filmes.senhor.dos.aneis$movieId) 

head(filmes.senhor.dos.aneis)



```

Na seleção da trilogia, descobrimos um filme inesperado "The Lord of the Rings (1978)", filme americano de 1978, criado e realizado por Ralph Bakshi. A longa metragem é uma adaptação da primeira parte da trilogia "O Senhor dos Anéis"(1954-1955) e foi feita por Peter S. Beagle e Chris Conkling. O filme contém animação e cenas live-action utilizando a técnica rotoscoped para dar-lhe uma aparência mais consistente e real a toda a acção do filme. 


Iremos verificar a quantidade de avaliações que cada filme teve 
```{r}
senhor.dos.aneis.ratings.quant = senhor.dos.aneis.ratings %>%
group_by(movieId) %>%
summarise(quantidade = n())

head(senhor.dos.aneis.ratings.quant)

```

Como podemos verificar, o filme de 1978 possui 19 avaliações, e considerando que não faz parte da trilogia (2001 a 2003), vamos retira-lo da análise.
E verificaremos a distribuição da amostra

```{r}
senhor.dos.aneis.ratings = senhor.dos.aneis.ratings %>%
  filter(movieId != 2116)

```

Agora vamos observar a distribuição das avaliações dos usuários:

```{r}
ggplot(senhor.dos.aneis.ratings, aes(rating)) +
  geom_bar() + 
  facet_wrap(~movieId, scales = c("free_y"))
```

```{r}

  ggplot(senhor.dos.aneis.ratings, aes(rating)) + 
     geom_histogram(binwidth = 1) + 
     facet_grid(. ~ movieId)

ggplot2.barplot(data=diamonds, xName="clarity",
          faceting=TRUE, facetingVarNames="cut", 
          facetingDirection="horizontal") 


```





