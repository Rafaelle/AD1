---
title: "Problema 4 - checkpoint 1"
output: html_document
---

```{r global_options, include=TRUE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE, fig.width=12, fig.height=6)
```

 


```{r echo=FALSE}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
theme_set(theme_bw())

filmes = read.csv("dados/movies.csv",  encoding="UTF-8")
ratings = read.csv("dados/ratings.csv",  encoding="UTF-8")

```

1 - Escolha uma trilogia (ou uma n-logia com n > 3) e avalie para qual dos episódios da trilogia há melhor avaliação e para qual há mais variação nas notas atribuídas ao filme.

Para a primeira parte, iremos escolher a trilogia Senhor dos Anéis.


```{r}

filmes.senhor.dos.aneis = filmes %>%
  filter(grepl('Lord of the Rings', title))

head(filmes.senhor.dos.aneis)

```

```{r}

# ratings.senhor.dos.aneis = ratings %>%
#   filter(movieId %in% filmes.senhor.dos.aneis$movieId) %>%
#   group_by(movieId) %>%
#   summarise(quantidade = n())
  
ratings.senhor.dos.aneis = ratings %>%
  filter(movieId %in% filmes.senhor.dos.aneis$movieId)%>%
  group_by(movieId)

ratings.senhor.dos.aneis$rating = as.numeric(ratings.senhor.dos.aneis$rating )

--------------------------------
#install.packages("resample")
library(resample)

experiment = sample_n(ratings.senhor.dos.aneis, 500, replace = TRUE)

b = experiment %>%
  group_by(movieId) %>%
  bootstrap(mean(rating), R = 500)


# tá fazendo a média geral 
b = bootstrap(experiment, mean(rating), R = 500)
mean.rating = CI.bca(b, probs = c(.025, .975))
mean.rating


b = bootstrap(experiment, median(rating))
median.rating = CI.percentile(b, probs = c(.025, .975))
median.rating 


df = data.frame(rbind(mean.rating, 
                      median.rating))
df$medida = row.names(df)

df %>% 
  ggplot(aes(x = medida, ymin = X2.5., ymax = X97.5.)) + 
  geom_errorbar(width = .2)


```


  https://github.com/nazareno/ciencia-de-dados-1/blob/master/4-Inferencia/Inferencia-2.Rmd
  https://github.com/odwl66/ad1/blob/master/problema4/problema4-checkpoint1.Rmd
  https://github.com/arthurlustosa/ad1/blob/master/Problema4/problema4-cp1.Rmd
  https://github.com/monkshorin/ad120161/blob/master/problema4/index.Rmd
  https://github.com/michellymenezes/AD1/blob/master/Prob4/prob4Cp1.Rmd
  https://github.com/jvmafra/AD1/blob/master/problema4-cp1/inferencia.Rmd
