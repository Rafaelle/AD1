
---
title: "Dados de gastos de parlamentares"
author: "Rafaelle Amorim"
date: "8 de julho de 2016"
output: html_document
---

```{r}
install.packages("dplyr")
install.packages("ggplot2")
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
theme_set(theme_bw())
```


Dados de gastos dos deputados de um periodo recente e valor das cotas por estado.

```{r}
gastos = read.csv("~/ufcg/AD1/problema-1/ano-atual.csv",  encoding="UTF-8")
cotas = read.csv("~/ufcg/AD1/problema-1/valor-cota-por-estado.csv",  encoding="UTF-8")
```


Para responder a pergunta proposta "Em que tipo de despesas nossos parlamentares gastam mais recursos de sua cota?", separamos os gastos de cada deputado por categoria de gasto, com isso, podemos selecionar apenas o "Tipo de Gasto" com maior despesa para cada um dos parlamentares.  


```{r fig.width=6, fig.height=12}
tipo.maior.despesa.deputado = gastos %>% 
  group_by(txtDescricao, txNomeParlamentar) %>% 
  summarise(total.despesa = sum(vlrLiquido)) %>%
  ungroup(tipo.maior.despesa.deputado) %>%
  group_by(txNomeParlamentar ) %>% 
  filter(total.despesa == max(total.despesa))
```

Agora agruparemos, usando a tabela anteriormente gerada, por "Tipo de Gasto" para obter qual categoria os deputados mais gastam.

```{r fig.width=6, fig.height=12}

total.tipo.despesa = tipo.maior.despesa.deputado %>%
  group_by(txtDescricao) %>%
  summarise(total = sum(total.despesa), quantidade.deputado = n())

grafico.valor.tipo.despesa = ggplot(total.tipo.despesa, aes(x = reorder(txtDescricao, total/1e6),y = total/1e6)) +
  geom_bar(stat = "identity") +
  xlab("Tipo de Gasto") + 
  ylab("Total gasto (milhões)") +
  coord_flip()
#adicionar mais intervalos

grafico.valor.tipo.despesa
         
```

Como podemos observar no gráfico, os três "Tipos de Gasto" com maiores custos da cota dos deputados são:
  - Divulgação de Atividades Parlamentar;
  - Consultorias, Pesquisa e Trabalhos Técnicos;
  - Emissão de Bilhete Aéreo.
  
Agora vamos tentar observar o quão dipersos esses valores estão:

```{r fig.width=6, fig.height=12}
grafico.dispersao.tipo.despesa = ggplot(total.tipo.despesa,aes(x = reorder(txtDescricao, total/1e6),y = total/1e6))  +  
  boxplot(total.tipo.despesa) +
  coord_flip()

grafico.dispersao.tipo.despesa
```






